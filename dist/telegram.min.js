!function(e){"use strict";function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,n){var r=[],t=!0,i=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(t=(u=a.next()).done)&&(r.push(u.value),!n||r.length!==n);t=!0);}catch(c){i=!0,o=c}finally{try{!t&&a["return"]&&a["return"]()}finally{if(i)throw o}}return r}return function(n,r){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),t=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}(),i=function(){function e(r){n(this,e),this.schema=r}return t(e,[{key:"setChannel",value:function(e){this.channel=e}},{key:"callApi",value:function(e,n){if(!this.channel)return Promise.reject(new Error("Cannot make API calls in this client without a channel"));var t=e.split("."),i=r(t,2),o=i[0],u=i[1],a=this.schema,c=new Error("Method does not exists: "+e);if(o=a.service[o],!o)return Promise.reject(c);var l=o[u];if(!l)return Promise.reject(c);var s=this._readProperties(n),f=this.channel;return new Promise(function(e,n){var r=function(r,t){return r?n(r):void e(t)};l({props:s,channel:f,callback:r})})}},{key:"_readProperties",value:function(e){var n={},r=this.schema;return Object.keys(e).forEach(function(t){var i=e[t];void 0!==i&&(i===!0&&(i=new r.type.BoolTrue),i===!1&&(i=new r.type.BoolFalse),n[t]=i)}),n}}]),e}(),o=function(){function e(){n(this,e)}return t(e,null,[{key:"configure",value:function(n,r){e.MTProto=n,e.TL=r}},{key:"useSchema",value:function(n){if(!e.TL)throw new Error("You must use Telegram.configure() first");var r=e.TL.TypeBuilder.buildTypes,t={_id:"api.type"};r(n.constructors,null,t,!1);var i={_id:"api.service"};r(n.methods,null,i,!0),e.schema={type:t,service:i}}},{key:"createClient",value:function(){return new i(e.schema)}}]),e}();o.Client=i,"function"==typeof define&&define.amd?define(function(){return o}):"undefined"!=typeof module&&module.exports?module.exports.Telegram=o:e.Telegram=o}(this);